' Computes v^T w for a vector 
set /dotproduct
    (
      do-to-all ( mul t1 t2 . ) v w .
      collapse ( add t1 t2 . ) ans "#" .
    ) .


' matrix-multiply A B computes A^T B 
set /matrix-multiply
    (
      set /i /#1 .
      set /out [ list . ] .
      while ( exist i B . )
            (
              do-to-all ( dotproduct /v t /w B:i . ) A .
              move /ans /res .
              in out ( set i res . ) .
              next i .
              move /ans /i .
            ) .
      answer out .
    ) .

' Computes A^T 
set /transpose
    (
      set /i /#1 .
      set /out [ list . ] .
      while ( exist i A:/#1 . )
            (
              do-to-all ( answer t:i . ) A .
              move /ans /res .
              in out ( set i res . ) .
              next i .
              move /ans /i .
            ) .
      answer out .
    ) .


set /A [ list [ list 1 2 . ] [ list 3 4 . ] . ] .
set /B [ list [ list 6 2 . ] [ list 3 4 . ] . ] .


